<ng-container *ngIf="user$ | async as user">
  <h1>
    {{ 'account.user.details.heading' | translate }}
  </h1>

  <div class="row section">
    <div class="col-10 col-lg-8">
      <h3>{{ 'account.user.details.profile.heading' | translate }}</h3>
      <div class="row">
        <div class="col-md-12">
          <dl class="row dl-horizontal dl-separator">
            <dt class="col-md-4">{{ 'account.user.details.profile.name' | translate }}</dt>
            <dd data-testing-id="name-field" class="col-md-8">
              <ng-container *ngIf="user.title">{{ user.title }} </ng-container> {{ user.firstName }} {{ user.lastName }}
            </dd>
            <dt class="col-md-4">{{ 'account.user.details.profile.email' | translate }}</dt>
            <dd data-testing-id="email-field" class="col-md-8">{{ user.email }}</dd>
            <dt class="col-md-4" data-testing-id="phone-label">
              {{ 'account.user.details.profile.phone' | translate }}
            </dt>
            <dd *ngIf="user.phoneHome" class="col-md-8">{{ user.phoneHome }}</dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-2 col-lg-4">
      <a
        routerLink="profile"
        class="btn-tool"
        [title]="'account.profile.update.link' | translate"
        data-testing-id="edit-user"
      >
        <fa-icon [icon]="['fas', 'pencil-alt']"></fa-icon>
      </a>
    </div>
  </div>

  <div *ngIf="user.roleIDs?.length" class="row section">
    <div class="col-10 col-lg-8">
      <h3>{{ 'account.user.details.profile.role_permissions.heading' | translate }}</h3>
      <div class="row">
        <div class="col-md-12" data-testing-id="user-roles-fields">
          <dl *ngFor="let role of roles$ | async" class="row dl-horizontal dl-separator">
            <dt class="col-md-4">{{ role.displayName }}</dt>
            <dd class="col-md-8">
              <ul class="pl-3">
                <li *ngFor="let p of role.permissionDisplayNames">{{ p }}</li>
              </ul>
            </dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-2 col-lg-4">
      <a
        routerLink="roles"
        class="btn-tool"
        [title]="'account.profile.update.link' | translate"
        data-testing-id="edit-roles"
      >
        <fa-icon [icon]="['fas', 'pencil-alt']"></fa-icon>
      </a>
    </div>
  </div>

  <div *ngIf="user.budgets" class="row section">
    <div class="col-10 col-lg-8">
      <h3>{{ 'account.user.details.profile.budget_limits.heading' | translate }}</h3>

      <div class="row">
        <div class="col-md-12" data-testing-id="user-budgets">
          <dl class="row dl-horizontal dl-separator">
            <dt class="col-md-4">{{ 'account.user.new.order_spend_limit.label' | translate }}</dt>
            <dd
              data-testing-id="order-spend-limit-field"
              class="col-md-8"
              *ngIf="user.budgets.orderSpentLimit; else noLimit"
            >
              {{ user.budgets.orderSpentLimit | ishPrice }}
            </dd>
            <ng-template #noLimit>
              <dd class="col-md-8">{{ 'approval.details.threshold.unlimited' | translate }}</dd>
            </ng-template>
            <ng-container *ngIf="user.budgets.budget; else noBudget">
              <dt class="col-md-4">
                {{ 'account.user.budget.label' | translate }} ({{
                  'account.user.new.budget.period.value.' + user.budgets.budgetPeriod | translate
                }})
              </dt>
              <dd data-testing-id="budget-field" class="col-md-8">
                {{ user.budgets.budget | ishPrice }}
              </dd>
            </ng-container>
            <ng-template #noBudget>
              <dt class="col-md-4">{{ 'account.user.budget.label' | translate }}</dt>
              <dd class="col-md-8">{{ 'account.budget.common.undefined' | translate }}</dd>
            </ng-template>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-2 col-lg-4">
      <!-- <a
        routerLink="budgets"
        class="btn-tool"
        [title]="'account.profile.update.link' | translate"
        data-testing-id="edit-budgets"
      >
        <fa-icon [icon]="['fas', 'pencil-alt']"></fa-icon>
      </a> -->
    </div>
  </div>
</ng-container>

<a routerLink=".." data-testing-id="back-to-user-management">{{
  'account.organization.user_management.back_to_list' | translate
}}</a>
